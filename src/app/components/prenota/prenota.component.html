<!-- prenota.component.html -->
<section class="hero fade-in-base">
  <div>
    <h1 class="fade-in">Spettacoli & Prenotazioni</h1>
    <p class="fade-in">Scopri le prossime date e prenota i biglietti.</p>
  </div>

  <!-- <a class="btn-brand" href="#calendar">Vai al calendario</a> -->
</section>

<section class="filters container">
  <div class="filter">
    <p-floatlabel variant="on">
      <p-select
        inputId="citiSel"
        [options]="cityOptions"
        [(ngModel)]="selectedCity"
        optionLabel="label"
        optionValue="value"
      ></p-select>
      <label for="citiSel">Città</label>
    </p-floatlabel>
  </div>

  <div class="filter">
    <p-floatlabel variant="on">
      <p-select
        inputId="monthSel"
        [options]="monthOptions"
        [(ngModel)]="selectedMonth"
        optionLabel="label"
        optionValue="value"
      ></p-select>
      <label for="monthSel">Mese</label>
    </p-floatlabel>
  </div>

  <div class="filter toggle">
    <p-toggle-switch type="checkbox" [(ngModel)]="includePast" />
    <label> Mostra spettacoli passati </label>
  </div>
</section>

<section class="cards container" id="prossime">
  @if (filteredShows.length === 0) {
  <p>Nessun evento trovato con i filtri selezionati.</p>
  } @else {
  <div class="grid">
    @for (s of filteredShows; track s.id) {
    <article class="card" pAnimateOnScroll enterClass="fade-in">
      @if (s.cover) {
      <img class="cover" [src]="s.cover" [alt]="s.title" loading="lazy" /> }
      <div class="body">
        <h3 class="title bebas">{{ s.title }}</h3>
        <p class="meta font-italic">
          <span class="date">{{
            s.date | date : "EEEE d MMMM, HH:mm" : "Europe/Rome"
          }}</span>
          <br />·
          <span class="place">{{ s.venue }} – {{ s.city }}</span>
        </p>
        @if (s.soldOut) {
        <span class="badge soldout">Sold out</span>
        } @else {
        <!-- Link Billetto: /select apre il widget (embed.js deve essere in index.html) -->
        @if(s.enabled){
        <a
          pButton
          [href]="s.billettoUrl"
          class="btn-ticket"
          (click)="$event.stopPropagation()"
          target="_blank"
        >
          <i class="fa-solid fa-ticket" aria-hidden="true"></i>
          <span class="label">Prenota ora</span>
          <span class="shine" aria-hidden="true"></span>
        </a>
        } @else {
        <span class="badge comingsoon">Prossimamente</span>
        } }
      </div>
    </article>
    }
  </div>
  }
</section>

<section class="trailer-section">
  <div class="trailer-container" pAnimateOnScroll enterClass="fade-in">
    <h3>TRAILER</h3>
    <iframe
      width="560"
      height="315"
      src="https://www.youtube.com/embed/bxLiwCvwp34?si=FLmgSjLI9Ha_7CXH"
      title="YouTube video player"
      frameborder="0"
      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
      referrerpolicy="strict-origin-when-cross-origin"
      allowfullscreen
    ></iframe>
  </div>
</section>

<section class="calendar alt" id="calendar">
  <div class="container">
    <h2 style="color: #2f408c; font-size: 3rem" class="text-center bebas">
      CALENDARIO COMPLETO
    </h2>
    <!-- Se usi il widget calendario/account di Billetto, inserisci qui il loro markup/link -->
    <script src="https://billetto.it/widget.js"></script>
    <billetto-organiser-widget
      type="calendar"
      organiser="6095917"
      organization="billetto.it"
      lang="it"
      theme="light"
      color="#4267b2"
      button-style="medium"
      font-family="Arial, Helvetica, sans-serif"
      background-color="#ffffff"
    ></billetto-organiser-widget>
    <a
      href="https://billetto.it/e/ID_CALENDARIO/select?color=%23F88D27"
      class="btn-outline"
      target="_blank"
    >
      Apri calendario Billetto
    </a>
  </div>
</section>
